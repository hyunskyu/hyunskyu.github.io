---
title: "Mean-Square Estimation (2) "
excerpt: "Estimation Theory 일부 정리"
use_math: true
---


앞서 소개한 특수한 케이스 3가지에서의 첫번째 케이스의 $\hat{x}_{MS}$를 구하는 과정을 살펴보았다.

이번에는 나머지 두 케이스를 알아볼 차례이다

- Conditional Mean for Linear Gaussian Measurement
- Linear Mean-Square Estimation

## Conditional Mean for Linear Gaussian Measurements

$x$와 $z$가 Gaussian process이고, 다음과 같은 Linear function을 따른다고 하자.

$z=Hx+v$

$x\sim N(\bar{x},P_x), \ v\sim N(0,R),E\{xv^T\}=0$ (uncorrelated)

이때, Mean 과 Covariance를 구해보자

$$
$\begin{array}{l}E\{z\}=E\{H x+v\}=H E\{x\} \\ \\P_{z}=E\left\{(z-\bar{z})(z-\bar{z})^{T}\right\} \\\quad=E\left\{(H x+v-H \bar{x})(H x+v-H \bar{x})^{T}\right\} \\\quad=H P_{x} H^{T}+\cfrac{E\left\{H x v^{T}\right\}}{=0}-\cfrac{H \bar{x} \bar{v}^{T}}{=0}+\cfrac{E\left\{v x^{T} H^{T}\right\}}{=0}-\cfrac{\bar{v} \bar{x}^{T} H^{T}}{=0}+R\end{array}$
$$

$\therefore P_{z}=H P_{x} H^{T}+R$

Cross-Covariance $P_{xz}$는

$$
$\begin{aligned}P_{x z} &=E\left\{(x-\bar{x})(z-\bar{z})^{T}\right\} \\&=E\left\{(x-\bar{x})(H x+v-H \bar{x})^{T}\right\} \\&=P_{x} H^{T}+\frac{E\left\{x v^{T}\right\}}{=0}-\cfrac{\bar{x} \bar{v}^{T}}{=0}\end{aligned}$
$$

$\Rightarrow \therefore P_{x z}=P_{x} H^{T}$

앞에서 구한 Covariance 식에 대입해보자,

$P_{x / z}=P_{x}-P_{x z} P_{z}^{-1} P_{z x}$———Covariance 식

$$
$\begin{aligned}P_{\widetilde{x}}=P_{x / z} &=P_{x}-P_{x z} P_{z}^{-1} P_{z x} \\&=P_{x}-P_{x} H^{T}\left(H P_{x} H^{T}+R\right)^{-1} H P_{x}\end{aligned}$
$$

$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\left(P_{x}^{-1}+H^{T} R^{-1} H\right)^{-1}$

※마지막 줄은 아래의 Lemma(보조정리)로 정리함

$\left(A_{11}^{-1}+A_{12} A_{22} A_{21}\right)^{-1}=A_{11}-A_{11} A_{12}\left(A_{21} A_{11} A_{12}+A_{22}^{-1}\right)^{-1} A_{21} A_{11}$

이제 $E\{x/z\}$를 구해보자

$\hat{x}(z)=E\{x / z\}=E\{x\}+P_{x z} P_{z}^{-1}(z-\bar{z})$

$=E\{x\}+P_{x} H^{T}\left(H P_{x} H^{T}+R\right)^{-1}(z-H \bar{x})$

$$
$\begin{aligned}P_{x} H^{T}\left(H P_{x} H^{T}+R\right)^{-1} &=P_{x} H^{T}\left(H P_{x} H^{T}+R\right)^{-1}\left[\left(H P_{x} H^{T}+R\right)-H P_{x} H^{T}\right] R^{-1} \\&=P_{x} H^{T}\left[I-\left(H P_{x} H^{T}+R\right)^{-1} H P_{x} H^{T}\right] R^{-1} \\&=\left[P_{x}-P_{x} H^{T}\left(H P_{x} H^{T}+R\right)^{-1} H P_{x}\right] H^{T} R^{-1} \\&=P_{x / z} H^{T} R^{-1}\end{aligned}$
$$

$\hat{x}(z)=\underbrace{E\{x\}}_{\text{prior part}}+\underbrace{P_{x / z} H^{T} R^{-1}(z-H \bar{x})}_{\text{posterior part}}$

## Linear Mean-Square Estimation

A와 b가 Constant matrix고 z가 non-Gaussian일 때

($z=Hx+v$와는 다른 형태임)

$\hat{x}(z)=Az+b$ 

Cost function $J$를 다음과 같이 정의하자

$$
$\begin{aligned}J &=E\left\{(x-\hat{x})^{T}(x-\hat{x})\right\} \\&=\operatorname{tr} E\left\{(x-\hat{x})(x-\hat{x})^{T}\right\} \\&=\operatorname{tr} E\left\{(x-A z-b)(x-A z-b)^{T}\right\} \\&=\operatorname{tr} E\left\{[(x-\bar{x})-(A z+b-\bar{x})][(x-\bar{x})-(A z+b-\bar{x})]^{T}\right\} \\&=\operatorname{tr}\left[P_{x}+A\left(P_{z}+\bar{z} \bar{z}^{T}\right) A^{T}+(b-\bar{x})(b-\bar{x})^{T}+2 A \bar{z}(b-\bar{x})^{T}-2 A P_{z x}\right]\end{aligned}$
$$
이를 최소화 하기 위해 A와 b에 대해 각각 미분을 해준다

$$
$\begin{array}{l}\cfrac{\partial J}{\partial b}=2(b-\bar{x})+2 A \bar{z}=0 \Rightarrow b=\bar{x}-A \bar{z} \\\cfrac{\partial J}{\partial A}=2 A\left(P_{z}+\overline{z z}^{T}\right)-2 P_{x z}+2(b-\bar{x}) \bar{z}^{T}=0 \Rightarrow A=P_{x z} P_{z}^{-1}\end{array}$
$$

앞서 구한 $A$와 $b$를 $\hat{x}(z)=Az+b$에 대입하면 최적의 Linear-Mean-Square estimation을 찾을 수 있다.

$\hat{x}_{L M S}(z)=E\{x\}+P_{x z} P_{z}^{-1}(z-\bar{z})$

$\left(\begin{array}{l}P_{x z}=P_{x} H^{T} \\ P_{z}=H P_{x} H^{T}+R\end{array}\right)$

그렇다면 정말 구한 $\hat{x}_{LMS}(z)$가 유효한지를 알아보자

구한 값이 유효하다면 다음을 만족시켜야 할 것이다

- $E\{\tilde{x}\}=0$
- $P_{\tilde{x}}=P_{x}-P_{x z} P_{z}^{-1} P_{z x}$

먼저 첫번째 조건이 맞는지 확인해 보자

$$
$\begin{aligned}E\left\{\hat{x}_{L M S}(z)\right\}=& E\left\{E\{x\}+P_{x z} P_{z}^{-1}(z-\bar{z})\right\} \\&=E\{x\}\end{aligned}$
$$

$E\{\tilde{x}\}=E\left\{x-\hat{x}_{LM S}(z)\right\}$

$=E\left\{x\}-E\{\hat{x}_{LM S}(z)\right\}$

$=E\{x\}-E\{x\}$

$=0$

$E\{\tilde{x}\}=0$ $\Rightarrow$첫번째 조건 만족

그 다음 두번째 조건을 확인해보자

$$
$\begin{aligned}P_{\tilde{x}} &=E\left\{(\tilde{x}-\overline{\tilde{x}})(\tilde{x}-\overline{\widetilde{x}})^{T}\right\} \\&=E\left\{\widetilde{x} \widetilde{x}^{T}\right\} \\&=E\left\{(x-\hat{x})(x-\hat{x})^{T}\right\} \\&=E\left\{\left[(x-\bar{x})-P_{x z} P_{z}^{-1}(z-\bar{z})\right]\left[(x-\bar{x})-P_{x z} P_{z}^{-1}(z-\bar{z})\right]^{T}\right\} \\&=P_{x}-P_{x z} P_{z}^{-1} P_{z x}-P_{x z} P_{z}^{-1} P_{z x}+P_{x z} P_{z}^{-1} P_{z} P_{z}^{-1} P_{z x} \\&=P_{x}-P_{x z} P_{z}^{-1} P_{z x}\end{aligned}$
$$

$P_{\tilde{x}}=P_{x}-P_{x z} P_{z}^{-1} P_{z x}$ $\Rightarrow$두번째 조건 만족

이로써 앞서 구한 $\hat{x}_{LMS}(z)$는 유효하다

$\hat{x}_{L M S}(z)=E\{x\}+P_{x z} P_{z}^{-1}(z-\bar{z})$

위의 식은 다음과 같은 성질을 갖고있다.

$\hat{x}_{L M S}(z)= \text{Prior estimate + Posterior estimate}$

$P_{x z} \operatorname{small}(=\text { less correlated }) \rightarrow \text { a posteriori correction effect small } \\ P_{z} \operatorname{large}(=\operatorname{less} \operatorname{confidence} \text{on}\  z) \rightarrow \text { small effect of }(z-\bar{z}) \\P_{z} \operatorname{small}(=\text { more confidence on } z) \rightarrow \text { large effect of }(z-\bar{z})$